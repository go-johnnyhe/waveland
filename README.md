# Shadow

Real-time code collaboration that works with any editor. Like Google Docs, but for your codebase.

<video src="demo.mp4"
       width="720"
       muted
       autoplay
       loop
       playsinline
       controls></video>

## Install

```bash
curl -sSf https://raw.githubusercontent.com/go-johnnyhe/shadow/main/install.sh | sh
```

## Quick Start

```bash
shadow
```

That's it. An interactive wizard walks you through starting or joining a session.

Or use the commands directly:

```bash
# Host — start sharing your project
shadow start .

# Partner — join with the generated URL
shadow join 'https://abc123.trycloudflare.com#<key>'
```

## How It Works

```
You (any editor)              Your partner (any editor)
       |                              |
       v                              v
  shadow start .                shadow join '<url>'
       |                              |
       +---- encrypted sync ----------+
                  (WebSocket)
```

1. Run `shadow start .` in your project directory
2. Share the generated URL with your partner
3. They run `shadow join '<url>'`
4. Both of you see live changes — `->` outgoing, `<-` incoming

Files are **end-to-end encrypted**. The server is a dumb relay that never sees your code. The encryption key lives in the URL fragment (`#<key>`) which is never sent to the server.

## Editor Support

Shadow works at the filesystem level, so it works with **any editor**:

| Editor | Setup |
|--------|-------|
| VS Code | Works out of the box |
| Vim / Neovim | Run `shadow setup-editor` for auto-reload |
| JetBrains IDEs | Works out of the box |
| Any other editor | Works if it detects file changes on disk |

## Options

### `shadow start`

| Flag | Description |
|------|-------------|
| `--read-only-joiners` | Joiners can view but not edit |
| `--key <secret>` | Use a custom encryption key (auto-generated by default) |
| `--path <path>` | Share path as a flag instead of positional argument |
| `--port <port>` | Server port (default 8080, auto-increments if taken) |
| `--force` | Bypass the large-directory safety prompt |

### `shadow join`

| Flag | Description |
|------|-------------|
| `--key <key>` | Provide encryption key separately (optional if included in URL) |

## Use Cases

- **Pair programming** — code together in real-time, each in your own editor
- **Technical interviews** — watch candidates code live without screenshare lag
- **Code reviews** — walk through changes together with live editing
- **Debugging sessions** — reproduce and fix issues collaboratively

## How Is This Different?

| | Shadow | VS Code Live Share | Screenshare |
|---|---|---|---|
| Editor lock-in | None | VS Code only | None |
| Latency | Low (WebSocket) | Low | High |
| Both can edit | Yes | Yes | No |
| Setup required | Zero | Extension install | None |
| Encryption | E2E | Microsoft servers | Varies |

## Architecture

Shadow uses a client-server model where the server is a pure message relay:

- **Tunnel**: Cloudflared creates a public HTTPS endpoint (downloaded automatically on first run to `~/.shadow/`)
- **Transport**: WebSocket with 30s heartbeat ping/pong
- **Encryption**: AES-256-GCM with HMAC-SHA256 key derivation, random 12-byte nonce per message
- **Sync**: fsnotify file watcher with 50ms debounce, SHA256 dedup to avoid redundant sends

## Limitations

- Optimized for project-sized directories — large repos (>100 MB) may be slow
- Last write wins — no merge conflict resolution
- Binary files are synced but not diffed

## Safety

Shadow includes guardrails to prevent accidents:

- Blocks sharing system directories (`/`, `~`, `/etc`, etc.)
- Warns before sharing directories with >500 files or >50 MB
- Respects `.gitignore` patterns
- Ignores `.git`, `node_modules`, swap files, and other common noise

---

Built with Go, WebSockets, and Cloudflare Tunnels. [Open source](https://github.com/go-johnnyhe/shadow).
